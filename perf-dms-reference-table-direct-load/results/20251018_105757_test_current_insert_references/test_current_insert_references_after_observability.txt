Output format is aligned.
Pager usage is off.
         captured_at          |           test_name            | snapshot_stage 
------------------------------+--------------------------------+----------------
 2025-10-18 15:57:57.89242+00 | test_current_insert_references | after
(1 row)


-- pg_stat_statements (calls ordered by total_exec_time)
                                                         query                                                          | calls |   total_exec_time   |    mean_exec_time    | rows | shared_blks_hit | shared_blks_read | shared_blks_dirtied | shared_blks_written | temp_blks_read | temp_blks_written 
------------------------------------------------------------------------------------------------------------------------+-------+---------------------+----------------------+------+-----------------+------------------+---------------------+---------------------+----------------+-------------------
 DO $$                                                                                                                 +|     1 |            3.906103 |             3.906103 |    0 |             137 |                0 |                   0 |                   0 |              0 |                 0
 BEGIN                                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
     IF EXISTS (SELECT 1 FROM pg_extension WHERE extname = 'pg_stat_statements') THEN                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
         PERFORM pg_stat_statements_reset();                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
     END IF;                                                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
 END                                                                                                                   +|       |                     |                      |      |                 |                  |                     |                     |                | 
 $$                                                                                                                     |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT schemaname,                                                                                                    +|     1 |  1.1875220000000002 |   1.1875220000000002 |    0 |             102 |                0 |                   0 |                   0 |              0 |                 0
        funcname,                                                                                                      +|       |                     |                      |      |                 |                  |                     |                     |                | 
        calls,                                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        total_time,                                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
        self_time                                                                                                      +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_stat_user_functions                                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE schemaname = $1                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
 ORDER BY total_time DESC                                                                                               |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT relname,                                                                                                       +|     1 | 0.25448000000000004 |  0.25448000000000004 |    0 |              23 |                0 |                   0 |                   0 |              0 |                 0
        heap_blks_hit,                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
        heap_blks_read,                                                                                                +|       |                     |                      |      |                 |                  |                     |                     |                | 
        idx_blks_hit,                                                                                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
        idx_blks_read,                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
        toast_blks_hit,                                                                                                +|       |                     |                      |      |                 |                  |                     |                     |                | 
        toast_blks_read                                                                                                +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_statio_user_tables                                                                                            +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE schemaname = $1                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
   AND relname IN ($2, $3, $4)                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
 ORDER BY relname                                                                                                       |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT query,                                                                                                         +|     1 | 0.22828400000000001 |  0.22828400000000001 |    4 |               4 |                0 |                   0 |                   0 |              0 |                 0
        calls,                                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        total_exec_time,                                                                                               +|       |                     |                      |      |                 |                  |                     |                     |                | 
        mean_exec_time,                                                                                                +|       |                     |                      |      |                 |                  |                     |                     |                | 
        rows,                                                                                                          +|       |                     |                      |      |                 |                  |                     |                     |                | 
        shared_blks_hit,                                                                                               +|       |                     |                      |      |                 |                  |                     |                     |                | 
        shared_blks_read,                                                                                              +|       |                     |                      |      |                 |                  |                     |                     |                | 
        shared_blks_dirtied,                                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
        shared_blks_written,                                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
        temp_blks_read,                                                                                                +|       |                     |                      |      |                 |                  |                     |                     |                | 
        temp_blks_written                                                                                              +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_stat_statements                                                                                               +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE dbid = (SELECT oid FROM pg_database WHERE datname = current_database())                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
 ORDER BY total_exec_time DESC                                                                                          |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT pid,                                                                                                           +|     1 |            0.191341 |             0.191341 |    0 |               3 |                0 |                   0 |                   0 |              0 |                 0
        application_name,                                                                                              +|       |                     |                      |      |                 |                  |                     |                     |                | 
        state,                                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        wait_event_type,                                                                                               +|       |                     |                      |      |                 |                  |                     |                     |                | 
        wait_event                                                                                                     +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_stat_activity                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE datname = current_database()                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
   AND application_name LIKE $1                                                                                        +|       |                     |                      |      |                 |                  |                     |                     |                | 
 ORDER BY pid                                                                                                           |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT backend_type,                                                                                                  +|     1 | 0.17607699999999998 |  0.17607699999999998 |    6 |               3 |                0 |                   0 |                   0 |              0 |                 0
        object,                                                                                                        +|       |                     |                      |      |                 |                  |                     |                     |                | 
        context,                                                                                                       +|       |                     |                      |      |                 |                  |                     |                     |                | 
        reads,                                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        read_time,                                                                                                     +|       |                     |                      |      |                 |                  |                     |                     |                | 
        writes,                                                                                                        +|       |                     |                      |      |                 |                  |                     |                     |                | 
        write_time,                                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
        extends,                                                                                                       +|       |                     |                      |      |                 |                  |                     |                     |                | 
         extend_time,                                                                                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
         fsyncs,                                                                                                       +|       |                     |                      |      |                 |                  |                     |                     |                | 
         fsync_time                                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_stat_io                                                                                                       +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE backend_type IN ($1, $2, $3)                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
 ORDER BY backend_type, object, context                                                                                 |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT CASE WHEN to_regclass($1) IS NULL THEN $2 ELSE $3 END AS has_pg_stat_wal                                        |     2 |            0.174794 |             0.087397 |    2 |               8 |                0 |                   0 |                   0 |              0 |                 0
 SELECT pg_stat_reset()                                                                                                 |     1 | 0.17105700000000001 |  0.17105700000000001 |    1 |               0 |                0 |                   0 |                   0 |              0 |                 0
 SELECT CASE WHEN EXISTS (SELECT $1 FROM pg_extension WHERE extname = $2) THEN $3 ELSE $4 END AS has_pg_stat_statements |     2 |            0.083683 |            0.0418415 |    2 |               2 |                0 |                   0 |                   0 |              0 |                 0
 SELECT now() AS captured_at,                                                                                          +|     2 | 0.07750900000000001 | 0.038754500000000004 |    2 |               0 |                0 |                   0 |                   0 |              0 |                 0
        $1::text AS test_name,                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        $2::text AS snapshot_stage                                                                                      |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT CASE WHEN EXISTS (                                                                                             +|     1 |            0.057589 |             0.057589 |    1 |               6 |                0 |                   0 |                   0 |              0 |                 0
            SELECT $1                                                                                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
            FROM pg_proc                                                                                               +|       |                     |                      |      |                 |                  |                     |                     |                | 
            WHERE proname = $2                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
        ) THEN $3 ELSE $4 END AS has_pgstattuple                                                                        |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT                                                                                                                +|     1 |            0.040349 |             0.040349 |    0 |               2 |                0 |                   0 |                   0 |              0 |                 0
     target_name,                                                                                                      +|       |                     |                      |      |                 |                  |                     |                     |                | 
     description,                                                                                                      +|       |                     |                      |      |                 |                  |                     |                     |                | 
     parent_document_ids,                                                                                              +|       |                     |                      |      |                 |                  |                     |                     |                | 
     parent_partition_keys,                                                                                            +|       |                     |                      |      |                 |                  |                     |                     |                | 
     reference_ids,                                                                                                    +|       |                     |                      |      |                 |                  |                     |                     |                | 
     reference_partition_keys,                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
     document_count,                                                                                                   +|       |                     |                      |      |                 |                  |                     |                     |                | 
     reference_count,                                                                                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
     requested_per_document,                                                                                           +|       |                     |                      |      |                 |                  |                     |                     |                | 
     min_per_document,                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
     max_per_document                                                                                                  +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM dms.perf_reference_targets                                                                                       +|       |                     |                      |      |                 |                  |                     |                     |                | 
 WHERE target_name = $1                                                                                                 |       |                     |                      |      |                 |                  |                     |                     |                | 
 SELECT                                                                                                                +|     1 |            0.031702 |             0.031702 |    1 |               0 |                0 |                   0 |                   0 |              0 |                 0
     wal_records,                                                                                                      +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_fpi,                                                                                                          +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_bytes,                                                                                                        +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_buffers_full,                                                                                                 +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_write,                                                                                                        +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_sync,                                                                                                         +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_write_time,                                                                                                   +|       |                     |                      |      |                 |                  |                     |                     |                | 
     wal_sync_time                                                                                                     +|       |                     |                      |      |                 |                  |                     |                     |                | 
 FROM pg_stat_wal                                                                                                       |       |                     |                      |      |                 |                  |                     |                     |                | 
 SET track_functions = 'pl'                                                                                             |     1 |            0.017495 |             0.017495 |    0 |               0 |                0 |                   0 |                   0 |              0 |                 0
 SET application_name = 'perf_current_insert_references'                                                                |     1 |            0.014609 |             0.014609 |    0 |               0 |                0 |                   0 |                   0 |              0 |                 0
 SET client_min_messages = 'warning'                                                                                    |     1 |            0.005533 |             0.005533 |    0 |               0 |                0 |                   0 |                   0 |              0 |                 0
(16 rows)


-- pg_stat_user_functions (dms schema only)
 schemaname | funcname | calls | total_time | self_time 
------------+----------+-------+------------+-----------
(0 rows)


-- pg_stat_statio_user_tables (Document/Alias/Reference)
 relname | heap_blks_hit | heap_blks_read | idx_blks_hit | idx_blks_read | toast_blks_hit | toast_blks_read 
---------+---------------+----------------+--------------+---------------+----------------+-----------------
(0 rows)


-- pg_stat_wal (if available)
 wal_records | wal_fpi |  wal_bytes  | wal_buffers_full | wal_write | wal_sync | wal_write_time | wal_sync_time 
-------------+---------+-------------+------------------+-----------+----------+----------------+---------------
   336168016 | 1165875 | 39339905687 |           607111 |    652059 |    39077 |              0 |             0
(1 row)


-- pgstattuple_approx (Reference table)

-- pg_stat_io (if available)
  backend_type  |    object     |  context  |  reads   | read_time |  writes  | write_time | extends | extend_time | fsyncs | fsync_time 
----------------+---------------+-----------+----------+-----------+----------+------------+---------+-------------+--------+------------
 checkpointer   | relation      | normal    |          |           |   143213 |          0 |         |             |   7554 |          0
 client backend | relation      | bulkread  |  1859761 |         0 |   103688 |          0 |         |             |        |           
 client backend | relation      | bulkwrite |   528038 |         0 |  1276776 |          0 |  861553 |           0 |        |           
 client backend | relation      | normal    | 29580192 |         0 | 28542461 |          0 |  648890 |           0 |      0 |          0
 client backend | relation      | vacuum    |   228007 |         0 |   197818 |          0 |       0 |           0 |        |           
 client backend | temp relation | normal    |        0 |         0 |        0 |          0 |       0 |           0 |        |           
(6 rows)


-- Wait events (sessions tagged with perf_ application_name)
 pid | application_name | state | wait_event_type | wait_event 
-----+------------------+-------+-----------------+------------
(0 rows)

