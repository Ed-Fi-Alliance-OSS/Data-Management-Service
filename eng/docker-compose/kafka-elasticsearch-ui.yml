# SPDX-License-Identifier: Apache-2.0
# Licensed to the Ed-Fi Alliance under one or more agreements.
# The Ed-Fi Alliance licenses this file to you under the Apache License, Version 2.0.
# See the LICENSE and NOTICES files in the project root for more information.

services:
  kafka-ui:
    image: provectuslabs/kafka-ui:latest
    container_name: kafka-ui
    depends_on:
      - kafka
    environment:
      DYNAMIC_CONFIG_ENABLED: 'true'
      KAFKA_CLUSTERS_0_NAME: kafka1
      KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka:9092
    ports:
      - '127.0.0.1:${KAFKA_UI_PORT:-8088}:8080'
    networks:
      - dms
    links:
      - kafka
      - kafka-postgresql-source
      - kafka-elasticsearch-sink

  kibana:
    image: docker.elastic.co/kibana/kibana:8.5.1
    depends_on:
      - elasticsearch
    environment:
      ELASTICSEARCH_HOSTS: http://dms-search:9200
      ELASTICSEARCH_USERNAME: ${ELASTICSEARCH_ADMIN_USERNAME:-admin}
      ELASTICSEARCH_PASSWORD: ${ELASTICSEARCH_ADMIN_PASSWORD:-abcdefgh1!}
    ports:
      - '127.0.0.1:${ELASTICSEARCH_DASHBOARD_PORT:-5601}:5601'
    networks:
      - dms

networks:
  dms:
    external: true
