Feature: Query String handling for GET requests for Resource Queries

@ignore
  Scenario: Ensure clients can GET information changing the casing of the query value to be all lowercase
    Given this school exists:
            | schoolId     | nameOfInstitution                    | gradeLevels                   | educationOrganizationCategories      |
            | 5            | School with max edorgId value        | [ "Postsecondary" ]           | [ "School" ]                         |
    When sending a GET request to "/ed-fi/schools?nameOfInstitution=ut+austin+college+of+education+graduate" 
            """
            """
    Then it should respond with 200
    And "nameOfInstitution: UT Austin College of Education Under Graduate" 

  @ignore
  Scenario: Ensure clients can GET information changing the casing of the query value to be all uppercase
    Given a school exists:
            | schoolId     | nameOfInstitution                                    | gradeLevels               | educationOrganizationCategories      |
            | 6            | UT Austin College of Education Under Graduate        | [ "Postsecondary" ]       | [ "Educator Preparation Provider" ]  |
    When sending a GET request to "/ed-fi/schools?nameOfInstitution=UT+AUSTIN+COLLEGE+OF+EDUCATION+UNDER+GRADUATE" 
            """
            """
    Then it should respond with 200
    And "nameOfInstitution: UT Austin College of Education Under Graduate" 


  @ignore
  Scenario: Ensure clients can GET information filtering by totalCount
    Given 8 schools exist:
    When sending a GET request to "/ed-fi/schools?totalCount=true&limit=7" 
    ##And "totalCount" 
            """
            """
    Then getting less than the "totalCount"
    And "totalCount: 7"

  
  @ignore
  Scenario: Ensure clients can't GET information when filtering using invalid values
    When sending a GET request to "/ed-fi/schools?limit=-1" using values as
            | Values                       |
            | -1                           |
            | 'zero'                       |
            | '5; select * from users'     |
            | '0)'                         |
            | '1%27'                       |   
    Then it should respond with 400
    And response is
             """
              {
                "detail": "Data validation failed. See 'validationErrors' for details.",
                "type": "urn:ed-fi:api:bad-request:data",
                "title": "Data Validation Failed",
                "status": 400,
                "correlationId": "9e4f71dd-013c-41ee-9eaf-9c3dc368d206",
                "validationErrors": {
                  "$.Limit": [
                    "The value 'zero' is not valid for Limit."
                  ]
                }
              }
             """ 
  
  @ignore
  Scenario: Ensure clients can get information when filtering by limit and and a valid offset 
    Given 5 schools exist:
            | schoolId     | nameOfInstitution                               | 
            | 5            | School with max edorgId value                   | 
            | 6            | UT Austin College of Education Under Graduate   |
            | 7            | UT Austin Extended Campus                       |
            | 255901001    | Grand Bend High School                          |
            | 255901044    | Grand Bend Middle School                        |
    When sending a GET request to "/ed-fi/schools?offset=3&limit=5"
            """
            """
    Then it should respond with status 200
    And schools returned:
            | 255901001    | Grand Bend High School                          |
            | 255901044    | Grand Bend Middle School                        | 
  
  
  @ignore
  Scenario: Ensure clients can get information when filtering by limit and offset greater than the total
    Given 5 schools exist:
            | schoolId     | nameOfInstitution                               | 
            | 5            | School with max edorgId value                   | 
            | 6            | UT Austin College of Education Under Graduate   |
            | 7            | UT Austin Extended Campus                       |
            | 255901001    | Grand Bend High School                          |
            | 255901044    | Grand Bend Middle School                        |
    When sending a GET request to "/ed-fi/schools?offset=6&limit=5"
            """
            """
    Then it should respond with status 200
    And "[]"

  @ignore
  Scenario: Ensure clients can't GET information when filtering by limit and offset using invalid values
    When sending a GET request to "/ed-fi/schools?limit=-6&offset=-1" using values as
            | Values                       |
            | -1                           |
            | 'zero'                       |
            | '5; select * from users'     |
            | '0)'                         |
            | '1%27'                       | 
    Then it should respond with 400
    And response body is
             """
             {
                "detail": "The limit parameter was incorrect.",
                "type": "urn:ed-fi:api:bad-request:parameter",
                "title": "Parameter Validation Failed",
                "status": 400,
                "correlationId": "b68e4051-8ed4-4055-9e59-4f9c2ef5f4ce",
                "errors": [
                "Limit must be omitted or set to a value between 0 and 500."
                ]
             }
             """  

  ##I need a few more details on this scenario
  @ignore
  Scenario: Ensure clients can't GET information when querying with filter and offset using limit without offset
    Given these schools exist:
            | schoolId     | nameOfInstitution                               | 
            | 5            | School with max edorgId value                   | 
            | 6            | UT Austin College of Education Under Graduate   |
    When sending a GET request to "/ed-fi/schools?limit=-6&offset=-1" 
            """
            """
    Then it should respond with 400
    And response body is
            """
            {
                "error": "The request is invalid.",
                "modelState": {
                      "limit": [
                            "Limit must be provided when using offset",
                      ],
                      "offset": [],
                },
            }
            """

  
  @ignore
  Scenario: Ensure clients can GET information when filtering with limits and properties
    Given these schools exist:
            | schoolId     | nameOfInstitution                               | 
            | 5            | School with max edorgId value                   | 
            | 6            | UT Austin College of Education Under Graduate   |
    When sending a GET request to "/ed-fi/schools?nameOfInstitution=UT+Austin+College+of+Education+Under+Graduate&limit=2" 
            """
            """
    Then it should respond with 200
    And response body is
            """
            {
              "id": "6ae6f59bb290479b9dc9cdae94bfe606",
              "schoolId": 6,
              "nameOfInstitution": "UT Austin College of Education Under Graduate",
              "addresses": [
                {
                  "addressTypeDescriptor": "uri://ed-fi.org/AddressTypeDescriptor#Physical",
                  "city": "Austin",
                  "postalCode": "78712",
                  "stateAbbreviationDescriptor": "uri://ed-fi.org/StateAbbreviationDescriptor#TX",
                  "streetNumberName": "1912 Speedway Stop D5000",
                  "nameOfCounty": "Travis",
                  "periods": []
                }
              ],
              "educationOrganizationCategories": [
                {
                  "educationOrganizationCategoryDescriptor": "uri://tpdm.ed-fi.org/EducationOrganizationCategoryDescriptor#Educator Preparation Provider"
                }
              ],
              "identificationCodes": [],
              "indicators": [],
              "institutionTelephones": [],
              "internationalAddresses": [],
              "_ext": {
                "tpdm": {
                  "postSecondaryInstitutionReference": {
                    "postSecondaryInstitutionId": 6000203,
                    "link": {
                      "rel": "PostSecondaryInstitution",
                      "href": "/ed-fi/postSecondaryInstitutions/559cbaa7be3147dfaa9d404c2939dea1"
                    }
                  }
                }
              },
              "schoolCategories": [],
              "gradeLevels": [
                {
                  "gradeLevelDescriptor": "uri://ed-fi.org/GradeLevelDescriptor#Postsecondary"
                }
              ],
              "_etag": "5250060893645579020",
              "_lastModifiedDate": "2023-12-06T19:25:21.8191116Z"
            },
            """   
            