Feature: Validation of Natural and Foreign Keys

        Background
            Given there is a School
                  | schoolId  | nameOfInstitution      | educationOrganizationCategoryDescriptor | gradeLevelDescriptor |
                  | 255901001 | Grand Bend High School | ["School"]                              | ["Eleventh grade"]   |
              And there is a Session
                  | sessionName               | schoolId  | schoolYear | beginDate  | endDate    | termDescriptor      | totalInstructionalDays |
                  | 2021-2022 Spring Semester | 255901001 | 2022       | 2022-01-04 | 2022-05-27 | ["Spring Semester"] | 88                     |
              And there is a Course
                  | courseCode | courseIdentificationSystemDescriptor | identificationCode | educationOrganizationId | courseTitle |
                  | ALG-1      | ["LEA course code"]                  | ALG-1              | 255901001               | Algebra I   |

        @ignore
        Scenario: 01 Verify clients can create a resource that contains repeated values from different references
            Given SchoolId value is {schoolId}
             When a POST request is made to "ed-fi/courseOfferings" with
                  """
                  {
                      "localCourseCode": "ALG-1 TEST-101",
                      "courseReference": {
                          "courseCode": "ALG-1",
                          "educationOrganizationId": 255901001
                      },
                      "schoolReference": {
                          "schoolId": {schoolId}
                      },
                      "sessionReference": {
                          "schoolId": {schoolId},
                          "schoolYear": 2022,
                          "sessionName": "2021-2022 Spring Semester"
                      }
                  }
                  """
             Then it should respond with 201

        @ignore
        Scenario: 02 Verify clients cannot create a resource using mismatching key values that are supposed to be the same
             When a POST request is made to "ed-fi/courseOfferings" with
                  """
                  {
                      "localCourseCode": "ALG-1 TEST-101",
                      "courseReference": {
                          "courseCode": "ALG-1",
                          "educationOrganizationId": 255901001
                      },
                      "schoolReference": {
                          "schoolId": 255901001
                      },
                      "sessionReference": {
                          "schoolId": 255901001,
                          "schoolYear": 2022,
                          "sessionName": "2021-2022 Spring Semester"
                      }
                  }
                  """
             Then it should respond with 400
              And the response body is
                  """
                  {
                      "detail": "Data validation failed. See 'validationErrors' for details.",
                      "type": "urn:ed-fi:api:bad-request:data-validation-failed",
                      "title": "Data Validation Failed",
                      "status": 400,
                      "correlationId": null,
                      "validationErrors": {
                          "$.schoolReference.schoolId": [
                              "All values supplied for 'schoolId' must match. Review all references and align the following conflicting values: '2559010010', '255901001'"
                          ],
                          "$.sessionReference.schoolId": [
                              "All values supplied for 'schoolId' must match. Review all references and align the following conflicting values: '2559010010', '255901001'"
                       ]
                      }
                  }
                  """

        @ignore
        Scenario: 03 Verify clients cannot update a resource using mismatching key values that are supposed to be the same
            Given Local Course Code "ALG-1 TEST-101"
            #set value to {id}
             When a PUT request is made to "ed-fi/courseOfferings/{id}" with
                  """
                  {
                      "localCourseCode": "ALG-1 TEST-101",
                      "courseReference": {
                          "courseCode": "ALG-1",
                          "educationOrganizationId": 255901001
                      },
                      "schoolReference": {
                          "schoolId": 255901001
                      },
                      "sessionReference": {
                          "schoolId": 2559010010,
                          "schoolYear": 2022,
                          "sessionName": "2021-2022 Spring Semester"
                      }
                  }
                  """
             Then it should respond with 400
              And the response body is
                  """
                  {
                     "detail": "Data validation failed. See 'validationErrors' for details.",
                     "type": "urn:ed-fi:api:bad-request:data-validation-failed",
                     "title": "Data Validation Failed",
                     "status": 400,
                     "correlationId": null,
                     "validationErrors": {
                         "$.schoolReference.schoolId": [
                             "All values supplied for 'schoolId' must match. Review all references and align the following conflicting values: '2559010010', '255901001'"
                         ],
                         "$.sessionReference.schoolId": [
                             "All values supplied for 'schoolId' must match. Review all references and align the following conflicting values: '2559010010', '255901001'"
                         ]
                     }
                  }
                  """


