Feature: Descriptors are a set of mechanisms to support flexible enumerations or code sets

        Background:
            Given the system has this "educationOrganizationCategoryDescriptors"
                  | codeValue | description | namespace                                               | shortDescription |
                  | School    | School      | uri://ed-fi.org/EducationOrganizationCategoryDescriptor | School           |
              And the system has this "disabilityDescriptors"
                  | codeValue       | description          | namespace                            | shortDescription     |
                  | Disability Test | User Disability Test | uri://ed-fi.org/DisabilityDescriptor | User Disability Test |

        @ignore
        Scenario: 01 / Ensure clients can create a Descriptor with the required attributes
             When a POST reques is made to "/ed-fi/disabilityDescriptors" with
                  """
                  {
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "codeValue": "Deaf-Blindness",
                      "shortDescription": "Deaf-Blindness",
                      "description": "Deaf-Blindness"
                  }
                  """
             Then it should respond with 201


        @ignore
        Scenario: 02 / Ensure clients can retrieve information of a Descriptor
             When a GET request is made to "/ed-fi/disabilityDescriptors"
             Then it should respond with 200
              And the response body is
                  """
                  [
                      {
                          "id": "{id}"
                          "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                          "codeValue": "Deaf-Blindness",
                          "shortDescription": "Deaf-Blindness",
                          "description": "Deaf-Blindness",

                      },
                      {
                          "id": "{id}"
                          "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                          "codeValue": "Disability Test",
                          "shortDescription": "User Disability Test",
                          "description": "User Disability Test",
                      }
                  ]
                  """

        @ignore
        Scenario: 03 / Ensure clients can update the values of a Descriptor
            Given the system has this codeValue "Deaf-Blindness"
             When a PUT request is made to "/ed-fi/disabilityDescriptors/{id}" with
                  """
                      {
                          "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                          "codeValue": "Deaf-Blindness Test",
                          "shortDescription": "Deaf-Blindness Test",
                          "description": "Deaf-Blindness Test"
                      }
                  """
             Then it should respond with 204

        @ignore
        Scenario: 04 / Ensure clients can create a descriptor using optional attributes
             When a POST request is made to "/ed-fi/disabilityDescriptors" with
                  """
                  {
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "codeValue": "Testing Deaf-Blindness",
                      "shortDescription": "Testing Deaf-Blindness",
                      "description": "Testing Deaf-Blindness",
                      "effectiveBeginDate": "2023-07-24",
                      "effectiveEndDate" "2030-07-24"
                  }
                  """
             Then it should respond with 201

        @ignore
        Scenario: 05 / Ensure clients can retrieve optional attributes from descriptors that have used them
            Given the system has this codeValue "Testing Deaf-Blindness"
             When a GET request is made to "/ed-fi/disabilityDescriptors/{id}"
             Then it should respond with 200
              And the response body is
                  """
                  {
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "codeValue": "Testing Deaf-Blindness",
                      "shortDescription": "Testing Deaf-Blindness",
                      "description": "Testing Deaf-Blindness",
                      "effectiveBeginDate": "2023-07-24",
                      "effectiveEndDate" "2030-07-24"
                  }
                  """

        @ignore
        Scenario: 06 / Ensure clients can add optional attributes to descriptors that do not include them
            Given the system has this codeValue "Deaf-Blindness"
             When a PUT request is made to "/ed-fi/disabilityDescriptors/{id}" with
                  """
                  {
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "codeValue": "Deaf-Blindness",
                      "shortDescription": "Deaf-Blindness",
                      "description": "Deaf-Blindness"
                      "effectiveBeginDate": "2024-07-24",
                      "effectiveEndDate" "2025-12-31"
                  }
                  """
             Then it should respond with 204

        @ignore
        Scenario: 07 / Ensure clients can retrieve a descriptor by requesting through a valid codeValue
            Given the system has this codeValue "Deaf-Blindness"
             When a GET request is made to "/ed-fi/disabilityDescriptors/{id}"
             Then it should respond with 200
              And the response body is
                  """
                  [
                      {
                          "id": "{id}",
                          "codeValue": "Deaf-Blindness",
                          "description": "Deaf-Blindness",
                          "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                          "shortDescription": "Deaf-Blindness",
                      }
                  ]
                  """

        @ignore
        Scenario: 08 / Ensure clients cannot retrieve a descriptor by requesting through a non existing codeValue
             When a GET request is made to "/ed-fi/disabilityDescriptors?codeValue=Test"
             Then it should respond with 200
              And the response body is
                  """
                  []
                  """

        @ignore
        Scenario: 09 / Ensure clients can retrieve a descriptor by requesting through a valid namespace
            Given the system has this namespace "uri://ed-fi.org/DisabilityDescriptor"
             When a GET request is made to "/ed-fi/disabilityDescriptors/{id}"
             Then it should respond with 200
              And the response body is
                  """
                  [
                      {
                          "id": "{id}",
                          "codeValue": "Deaf-Blindness",
                          "description": "Deaf-Blindness",
                          "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                          "shortDescription": "Deaf-Blindness",
                      }
                  ]
                  """

        @ignore
        Scenario: 10 / Ensure clients cannot retrieve a descriptor by requesting through a non existing namespace
             When a GET request is made to "/ed-fi/disabilityDescriptors?namespace=uri://ed-fi.org/DisabilityDescriptorFake"
             Then it should respond with 200
              And the response body is
                  """
                  []
                  """

        @ignore
        Scenario: 11 / Ensure clients cannot create a descriptor omitting any of the required values
             When a POST request is made to "/ed-fi/disabilityDescriptors" with
                  """
                  {
                      "codeValue": "Deaf-Blindness",
                      "shortDescription": "Deaf-Blindness",
                      "description": "Deaf-Blindness"
                  }
                  """
             Then it should respond with 400
              And the response body is
                  """
                  {
                      "detail": "Data validation failed. See 'validationErrors' for details.",
                      "type": "urn:ed-fi:api:bad-request:data-validation-failed",
                      "title": "Data Validation Failed",
                      "status": 400,
                      "correlationId": null,
                      "validationErrors": {
                          "$.namespace": [
                              "Namespace is required."
                          ]
                      }
                  }
                  """

        @ignore
        Scenario: 12 / Ensure clients cannot update a descriptor omitting any of the required values
             When a POST request is made to "/ed-fi/disabilityDescriptors" with
                  """
                  {
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "shortDescription": "Deaf-Blindness",
                      "description": "Deaf-Blindness"
                  }
                  """
             Then it should respond with 400
              And the response body is
                  """
                  {
                      "detail": "Data validation failed. See 'validationErrors' for details.",
                      "type": "urn:ed-fi:api:bad-request:data-validation-failed",
                      "title": "Data Validation Failed",
                      "status": 400,
                      "correlationId": null,
                      "validationErrors": {
                          "$.namespace": [
                              "CodeValue is required."
                          ]
                      }
                  }
                  """

        @ignore
        Scenario: 13 / Ensure clients can update a descriptor that is not being used by any resource
            Given the system has this codeValue "Visual Impairment, including Blindness"
             When a PUT request is made to "/ed-fi/disabilityDescriptors/{id}" with
                  """
                  {
                      "codeValue": "Visual Impairment, including Blindness",
                      "description": "Visual Impairment, including Blindness",
                      "namespace": "uri://ed-fi.org/DisabilityDescriptor",
                      "shortDescription": "Visual Impairment, including Blindness EdFi Test"
                  }
                  """
             Then it should respond with 204

        @ignore
        Scenario: 14 / Ensure clients cannot update a descriptor changing identifying values
            Given the system has this codeValue "Visual Impairment, including Blindness"
             When a PUT request is made to "/ed-fi/disabilityDescriptors/{id}" with
                  """
                  {
                      "codeValue": "Visual Impairment, including Blindness Ed-Fi Test",
                      "description": "Visual Impairment, including Blindness",
                      "namespace": "uri://ed-fi.org/DisabilityDescriptorEd-FiTest",
                      "shortDescription": "Visual Impairment, including Blindness"
                  }
                  """
             Then it should respond with 409
              And the response body is
                  """
                  {
                      "detail": "Identifying values for the DisabilityDescriptor data cannot be changed. Delete and recreate the item instead.",
                      "type": "urn:ed-fi:api:bad-request:data-validation-failed:key-change-not-supported",
                      "title": "Key Change Not Supported",
                      "status": 400,
                      "correlationId": null
                  }
                  """

        @ignore
        Scenario: 15 / Ensure clients can delete a descriptor that is not beign used by any resource
            Given the system has codeValue "Disability Test"
             When a DELETE request is made to "/ed-fi/disabilityDescriptors/{id}"
             Then it should respond with 204

        @ignore
        Scenario: 16 / Ensure clients cannot delete a descriptor that is beign used by any resource
            Given the system has codeValue "School"
             When a DELETE request is made to "/ed-fi/educationOrganizationCategoryDescriptors/{id}"
             Then it should respond with 409
              And the response body is
                  """
                  {
                      "detail": "The requested action cannot be performed because this item is referenced by an existing 'EducationOrganizationCategory' item.",
                      "type": "urn:ed-fi:api:data-conflict:dependent-item-exists",
                      "title": "Dependent Item Exists",
                      "status": 409,
                      "correlationId": null
                  }
                  """







