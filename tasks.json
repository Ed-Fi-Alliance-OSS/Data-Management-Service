[
  {
    "category": "Refactor",
    "description": "DMS-931: Refactor constraint derivation to separate logical constraint identity from physical constraint name (internal-only) so DMS-931 can safely rewrite physical identifiers later. Acceptance: (1) All internal “already exists”/dedupe checks for FK/UK/CK constraints are based on semantic identity (kind + owning table + ordered local columns + target table/columns + referential actions) rather than string names; (2) no derivation pass relies on the current physical name being final; (3) the public `DerivedRelationalModelSet` contract remains unchanged (still carries only final physical names); (4) unit tests demonstrate dedupe/contain behavior remains correct after a renaming pass rewrites physical names.",
    "steps-to-verify": [
      "Introduce an internal constraint identity/signature representation and update constraint-related helpers (e.g., `ConstraintDerivationHelpers.Contains*`) and passes to use semantic identity instead of `Name` strings.",
      "Ensure all constraint emission still sets *some* physical name before the model is finalized, but treat it as rewriteable by DMS-931 passes.",
      "Add/adjust unit tests to prove constraints are not duplicated when physical names change (e.g., run the naming/shortening pass and assert constraint counts/semantics are stable).",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  },
  {
    "category": "Naming",
    "description": "DMS-931: Replace verbose constraint naming (`UX_{Table}_{Col1}_{Col2}_...`, `FK_{Table}_{Col1}_{Col2}_...`) with purpose-based names that avoid repeating shared reference prefixes, and append `_{h10}` (first 10 hex of SHA-256 of a canonical constraint signature) only when the resulting name would exceed the target dialect identifier limit (Pgsql 63 bytes, Mssql 128 chars). Acceptance: (1) FK/UK/CK names are derived from the owning table plus stable role tokens (e.g., reference base name, `NK`, `RefKey`, `AllNone`) instead of concatenating the full physical column list; (2) composite reference FKs use a single reference token (no `ReferenceBaseName_` duplication per column); (3) `h10` is present only when required by the dialect max length; otherwise the name contains no hash suffix; (4) hashing uses a canonical signature string that includes at least kind, owning table, ordered local columns, target table, ordered target columns, and referential actions so it is deterministic and collision-resistant; (5) names are deterministic and stable across runs; (6) names are unique post-shortening (collisions fail fast with structured collision records); (7) update the authoritative expected outputs so the unique constraint currently at `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/Fixtures/authoritative/sample/expected/authoritative-derived-relational-model-set.json:2456` and the FK at `...:2630` no longer contain duplicated reference prefixes and are within the Pgsql limit; (8) unit tests cover within-limit (no hash) and over-limit (hash) cases for both FK and UK naming.",
    "steps-to-verify": [
      "Introduce a constraint naming service/helper that generates a short, semantic base name per constraint kind/purpose and only appends `_{h10}` when the dialect max identifier length would be exceeded.",
      "Update all constraint derivation code to use the new naming strategy (FK/UK/CK, including all-or-none checks) and to avoid embedding repeated reference prefixes.",
      "Update `reference/design/backend-redesign/design-docs/data-model.md` constraint naming section to match the implemented strategy (purpose tokens + optional length-driven `h10`).",
      "Update the authoritative expected fixture outputs and add unit tests asserting the example constraints no longer repeat reference prefixes and that `h10` is absent when the base name is within the dialect limit.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Naming",
    "description": "DMS-931: Implement `resourceSchema.relational.rootTableNameOverride` and ensure the root base name flows through *all* derived artifacts. Acceptance: (1) `rootTableNameOverride` is normalized via `RelationalNameConventions.ToPascalCase` and must be non-empty after normalization; (2) it affects everything derived from the root base name: root table, child table names, `{RootBaseName}_DocumentId` key-part columns, extension table prefixes `{RootBaseName}Extension*`, abstract identity table/view names, and constraint/index/trigger naming tokens derived from table/column names; (3) `rootTableNameOverride` on `isResourceExtension:true` schemas fails fast; (4) any `relational` block on `isDescriptor:true` resources fails fast (descriptor resources still allow overrides on descriptor *references* via their JSONPaths in non-descriptor resources); (5) behavior is deterministic and covered by unit tests.",
    "steps-to-verify": [
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtractInputsStep.cs` to extract/validate `relational.rootTableNameOverride` and to fail fast on descriptor resources and resource-extension schemas as specified.",
      "Implement a DMS-931 naming pass that rewrites the derived model’s root base name and all dependent identifiers consistently (tables, key columns, abstract artifacts, extension artifacts).",
      "Add unit tests using hand-authored fixtures that assert rootTableNameOverride changes child table names and key-part column names deterministically.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  },
  {
    "category": "Naming",
    "description": "DMS-931: Implement full `resourceSchema.relational.nameOverrides` semantics (beyond DMS-930 placeholders) and remove temporary restrictions. Acceptance: (1) Override keys are parsed and canonicalized using the restricted JSONPath grammar (`$`, `.prop`, `[*]` only); (2) override values are normalized with `RelationalNameConventions.ToPascalCase` and must be non-empty after normalization; (3) known keys are limited to derived columns and array table scopes (including elements under `_ext`); unknown keys fail fast with diagnostics that include both raw key text and canonical form plus owning resource; (4) scalar overrides replace the entire computed column base name (including inlined prefixes), not just the leaf; (5) reference-object overrides at the reference object path rename the entire reference bundle (FK `..._DocumentId`, propagated reference identity columns, and any constraint/index/trigger names that include those physical names); inside-reference overrides are allowed only for reference identity paths (keys that exactly match one of the mapping’s `documentPathsMapping.*.referenceJsonPaths[*].referenceJsonPath` canonicals) and override the propagated identity column base name + corresponding binding metadata; any other key inside a reference object (e.g., `$.schoolReference.link`) is invalid and fails fast; (6) collection overrides are interpreted as the collection segment/base name for that array scope and apply to both child-table naming and ordinal key-part column naming; nested collection override values do not need to start with the parent suffix, and ancestor collection overrides do not require explicit descendant overrides; (7) for compatibility across authoring styles, collection override values may be segment-only or fully-qualified; when fully-qualified, deterministically strip any already-implied root/ancestor prefixes before applying so the effective segment/base name is unambiguous and deterministic; (8) extension resource schemas (`isResourceExtension:true`) may specify `relational.nameOverrides` only (no `rootTableNameOverride`), supporting both relative keys and fully-qualified `$._ext.{projectKey}...` keys; relative keys are auto-prefixed to `$._ext.{resolvedProjectKey}...` using the exact key found in the base resource schema’s `_ext` site (case-sensitive match); (9) fail fast when a base resource override and an extension schema override target the same canonical derived element; (10) collisions introduced by overrides fail fast with structured collision records.",
    "steps-to-verify": [
      "Replace the DMS-930 placeholder override extraction in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtractInputsStep.cs` so all overrides are captured for DMS-931 and reference-only restrictions are removed.",
      "Implement restricted-JSONPath override parsing/validation and apply overrides to derived identifiers at the correct stage (before suffixes like `_DocumentId`/`_DescriptorId` and before dialect shortening).",
      "Add unit tests (hand-authored fixtures) covering: scalar override (including inlined objects), reference-object override, inside-reference identity override (allowed) + non-identity inside-reference key failure, collection overrides + remainder ordinal naming (no descendant requirement; no parent-prefix requirement; segment-only vs fully-qualified compatibility), unknown key diagnostics (raw + canonical), extension-schema override auto-prefixing, and base-vs-extension override conflict failure.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Naming",
    "description": "DMS-931: Implement deterministic collision detection with a structured “collision record” format for naming/overrides/shortening. Acceptance: (1) Collision diagnostics always answer what collided (identifier kind), where (schema/table and owning resource + JSONPath where applicable), and why (stage + pre→post mapping); (2) stages are explicit (e.g., `AfterSchemaNormalization`, `AfterOverrideNormalization`, `AfterDialectShortening(Pgsql:63-bytes)`); (3) collision records are formatted deterministically (stable ordering) and include both pre- and post-normalization/shortening identifiers; (4) override collisions and shortening collisions both use the same record model; (5) unit tests assert deterministic formatting for at least one collision scenario.",
    "steps-to-verify": [
      "Introduce collision record types + deterministic formatter, and update/replace `IdentifierCollisionDetector` so collisions can report stage and pre→post mapping.",
      "Use the collision record format for: override-induced collisions, dialect-shortening collisions, and any other fail-fast naming collisions introduced by DMS-931.",
      "Add unit tests that assert collision diagnostics include kind + location + stage + pre→post mapping and are deterministically ordered.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Naming",
    "description": "DMS-931: Apply dialect identifier shortening into the derived model (not just collision detection), including schema names. Today `RelationalModelSetBuilderContext.BuildResult` detects shortening collisions, but the model still stores pre-shortened identifiers, forcing every downstream consumer to remember to shorten consistently. Acceptance: (1) A set-level pass rewrites *all* derived identifiers using `context.DialectRules.ShortenIdentifier` and stores the shortened names in the `DerivedRelationalModelSet` (schemas, tables, columns, constraints, indexes, triggers, abstract identity tables/views); (2) all internal references are updated consistently (FK `TargetTable/TargetColumns`, `DocumentReferenceBinding.Table/FkColumn/IdentityBindings`, `DescriptorEdgeSource`, index/trigger `Table/KeyColumns`, etc.); (3) the pass is deterministic and idempotent (running twice yields the same model); (4) collision detection still fails fast when multiple original identifiers shorten to the same value, using the structured collision record format; (5) unit tests cover overlong table/column/constraint/index/trigger/schema names and assert the shortened identifiers are present in the output and referenced correctly; (6) all unit tests pass and the DMS solution builds.",
    "steps-to-verify": [
      "Implement a new set-level pass (e.g., `ApplyDialectIdentifierShorteningRelationalModelSetPass`) that rewrites identifiers in-place on `RelationalModelSetBuilderContext` inventories using `DialectRules.ShortenIdentifier` and updates all references consistently (including `ProjectSchemasInEndpointOrder[*].PhysicalSchema`).",
      "Register the pass in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/RelationalModelSetPasses.cs` after the DMS-931 naming/override/constraint-naming pass and before `CanonicalizeOrderingRelationalModelSetPass`.",
      "Add unit tests that force overlong identifiers (including schema names) and assert the shortened names are stored in the resulting `DerivedRelationalModelSet` and referenced correctly by constraints/bindings/inventories. Include at least one Pgsql (63-byte) and one Mssql (128-char) case.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  },
  {
    "category": "Testing",
    "description": "DMS-931: Add “naming-stress” hand-authored fixtures + extend authoritative expected outputs (inputs unchanged). Acceptance: (1) New unit tests are built from `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/Fixtures/set-builder/*` fixtures and exercise: long names, `rootTableNameOverride`, scalar/reference/array overrides (including nested-array remainder ordinal naming, inside-reference identity overrides, and nested collection override compatibility without descendant/prefix requirements), extension-schema override auto-prefixing, reserved-word/edge-case normalization, and collision diagnostics; (2) authoritative fixture inputs remain unchanged; only `expected/` outputs are updated to reflect new naming/override/constraint-naming/shortening behavior; (3) the authoritative derived model set JSON comparisons pass; (4) the DMS solution builds.",
    "steps-to-verify": [
      "Add/extend hand-authored fixture inputs under `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/Fixtures/set-builder/` to cover naming stress scenarios without requiring changes to authoritative inputs.",
      "Update authoritative `expected/authoritative-derived-relational-model-set.json` files to match the new deterministic naming + constraint naming + shortening behavior.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  },
  {
    "category": "Design",
    "description": "DMS-931: Update backend-redesign override design docs to match authoritative goldens (inside-reference identity overrides allowed; relaxed collection override rules). Acceptance: (1) `reference/design/backend-redesign/design-docs/flattening-reconstitution.md` no longer states that identity paths inside reference objects are invalid; it distinguishes reference-object overrides vs reference-identity overrides and constrains inside-reference overrides to reference identity JSONPaths; (2) the doc removes any requirement that nested collection override values start with the parent suffix or that descendant collection overrides are required; (3) the doc states collection override values are interpreted as the collection segment/base name and allows fully-qualified values via deterministic stripping of already-implied root/ancestor prefixes; (4) examples include at least one inside-reference identity override and one ancestor-only collection override.",
    "steps-to-verify": [
      "Update `reference/design/backend-redesign/design-docs/flattening-reconstitution.md` sections 3.2/3.3 to reflect the updated rules (reference-object override vs reference-identity override; relaxed collection rules; prefix-stripping compatibility) and add/adjust examples accordingly.",
      "Confirm `reference/design/backend-redesign/design-docs/flattening-reconstitution.md` language matches the updated DMS-931 acceptance text in `tasks.json` (no contradictions)."
    ],
    "completed": true
  },
  {
    "category": "Backend",
    "description": "DMS-931: Allow inside-reference identity overrides during input validation (reject non-identity inside-reference keys). Acceptance: (1) `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtractInputsStep.cs` allows an override key inside a reference object only if it exactly matches one of the mapping’s `ReferenceJsonPaths[*].ReferenceJsonPath` canonicals; (2) authoritative overrides like `$.graduationSchoolYearTypeReference.schoolYear` are accepted; (3) non-identity inside-reference keys (e.g., `$.schoolReference.link`) still fail fast with diagnostics that include raw key text + canonical form.",
    "steps-to-verify": [
      "Update inside-reference validation in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtractInputsStep.cs` (near the existing inside-reference failure) to allow only reference identity JSONPaths from the mapping and to fail fast on other inside-reference keys.",
      "Update/add unit tests in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/SchemaInputValidationTests.cs` to cover allowed inside-reference identity override and rejected non-identity inside-reference key.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Backend",
    "description": "DMS-931: Apply inside-reference identity overrides to propagated reference identity column base names. Acceptance: (1) `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ReferenceBindingRelationalModelSetPass.cs` consults `nameOverrides` for each `identityBinding.ReferenceJsonPath` and applies the override value to the propagated identity column base name when present; (2) any binding metadata that depends on the identity column base name is updated consistently so downstream lookups/reconstitution use the overridden names; (3) if both a reference-object override and an inside-reference identity override are present, the identity override wins for the specific identity column while the reference-object override still applies to the reference bundle artifacts (FK `..._DocumentId`, etc.).",
    "steps-to-verify": [
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ReferenceBindingRelationalModelSetPass.cs` to consult `TryGetNameOverride(identityBinding.ReferenceJsonPath, Column)` (or equivalent) when creating propagated identity columns and apply the override to the identity column base name.",
      "Add/adjust unit tests to assert a reference identity column can be renamed via an inside-reference identity override without renaming non-identity keys inside the reference.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Backend",
    "description": "DMS-931: Relax collection override derivation (no descendant override requirement; no parent-prefix requirement) and add prefix-stripping compatibility. Acceptance: (1) `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/DeriveTableScopesAndKeysStep.cs` and `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtensionTableDerivationRelationalModelSetPass.cs` no longer throw when an ancestor collection override exists without descendant overrides; (2) nested collection override values do not need to start with the parent suffix; (3) collection override values are resolved to an effective segment by deterministically stripping already-implied root/ancestor prefixes when present, so segment-only and fully-qualified values produce the same derived names; (4) authoritative fixture shapes like `CommunityOrganization` with only `$.indicators[*]` override build successfully.",
    "steps-to-verify": [
      "Remove the \"descendant override required\" checks from `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/DeriveTableScopesAndKeysStep.cs` and `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtensionTableDerivationRelationalModelSetPass.cs`.",
      "Replace the strict `StartsWith(parentSuffix)` logic in both files with a compatibility resolver that computes the effective segment/base name and deterministically strips implied root/ancestor prefixes when present (no hard requirement).",
      "Update/add unit tests in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/NameOverrideTests.cs` to cover missing descendant overrides and nested overrides without parent-prefix requirements.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Testing",
    "description": "DMS-931: Update schema input validation tests for inside-reference identity overrides. Acceptance: (1) `SchemaInputValidationTests` accepts an inside-reference override whose key matches a reference identity JSONPath from the mapping; (2) it rejects a non-identity inside-reference key such as `$.schoolReference.link`.",
    "steps-to-verify": [
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/SchemaInputValidationTests.cs` to add/adjust tests around the existing inside-reference validation coverage.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Testing",
    "description": "DMS-931: Update override derivation tests to allow missing descendant collection overrides. Acceptance: (1) The previous \"missing descendant override\" fixture no longer throws; (2) tests assert the expected derived table scope names/keys when an ancestor collection override exists without a descendant override.",
    "steps-to-verify": [
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/NameOverrideTests.cs` (near the existing descendant override test) to assert successful build + expected naming behavior instead of asserting an exception.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Testing",
    "description": "DMS-931: Add a focused unit test proving nested collection overrides work without the parent-prefix form (and that fully-qualified values are compatible). Acceptance: (1) A nested collection override value that does not start with the parent suffix is accepted; (2) a fully-qualified nested override value that includes implied prefixes yields the same effective derived names as the segment-only form.",
    "steps-to-verify": [
      "Add a new unit test (and any minimal fixture) under `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/` covering nested collection override segment resolution and prefix-stripping compatibility.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`"
    ],
    "completed": true
  },
  {
    "category": "Verification",
    "description": "DMS-931: Verify override alignment changes against authoritative goldens. Acceptance: (1) `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj` passes; (2) `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln` succeeds; (3) no authoritative input fixtures were modified (only code/docs/expected outputs as needed).",
    "steps-to-verify": [
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`",
      "Confirm no changes under `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/Fixtures/authoritative/*/inputs/`."
    ],
    "completed": true
  },
  {
    "category": "Validation",
    "description": "DMS-931 follow-up: Close collision detection gaps for direct duplicate identifiers by updating `OverrideCollisionDetector` and `IdentifierCollisionDetector` to collide on multiple distinct origins, not only multiple distinct original identifier strings. Acceptance: (1) Build fails when two distinct derived elements share the same final identifier in a collision scope even when their original identifier strings are identical (e.g., root table name collisions created by `rootTableNameOverride`); (2) de-duplication only suppresses truly duplicate registrations of the same element (same origin), not distinct derived elements; (3) diagnostics remain deterministic and include the collision stage, scope, and origin details (resource label + JSONPath) for each conflicting source; (4) existing collision tests remain passing.",
    "steps-to-verify": [
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/OverrideCollisionDetector.cs` to treat multiple unique origins for the same final identifier as a collision even when `OriginalIdentifier` matches.",
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/IdentifierCollisionDetector.cs` to treat multiple unique origins for the same shortened identifier as a collision even when `OriginalIdentifier` matches.",
      "Ensure collision-source ordering remains deterministic (Ordinal) and stage labels remain accurate (`AfterOverrideNormalization`, `AfterDialectShortening`).",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  },
  {
    "category": "Testing",
    "description": "DMS-931 follow-up: Add regression tests covering `rootTableNameOverride` collisions (root-vs-root and root-vs-child table name collisions). Acceptance: (1) A fixture where two resources in the same physical schema resolve to the same root table name via `relational.rootTableNameOverride` fails fast during derived model build; (2) a fixture where a resource root table name collides with another resource's child collection table name fails fast; (3) the exception message includes both resources and the colliding identifiers with actionable origins (resource label + JSON scope/path); (4) behavior is deterministic across resource ordering.",
    "steps-to-verify": [
      "Add a minimal hand-authored fixture under `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/Fixtures/set-builder/` containing two resources that collide via `rootTableNameOverride`.",
      "Add a second fixture where `rootTableNameOverride` produces a root table name that collides with another resource's derived child table name.",
      "Add a new NUnit fixture (e.g., `RootTableNameOverrideCollisionTests`) asserting the build throws `InvalidOperationException` with an actionable collision record.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": false
  },
  {
    "category": "Refactor",
    "description": "DMS-931 follow-up: Remove the unused `hasOverriddenAncestor` state in collection table derivation to reduce complexity. Acceptance: (1) `hasOverriddenAncestor` is either removed from `DeriveTableScopesAndKeysStep` / `ExtensionTableDerivationRelationalModelSetPass` (and any callers) or used for a clearly-defined behavior; (2) derived outputs are unchanged (goldens + unit tests stay green); (3) no dead code remains.",
    "steps-to-verify": [
      "Verify `hasOverriddenAncestor` is unused in `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/DeriveTableScopesAndKeysStep.cs` and `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ExtensionTableDerivationRelationalModelSetPass.cs`.",
      "Remove the parameter and all plumbing (or introduce a tested behavior if it is intended to mean something).",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": false
  },
  {
    "category": "Cleanup",
    "description": "DMS-931 follow-up: Remove the unused legacy helper `RelationalNameConventions.ForeignKeyName` (superseded by `ConstraintNaming`) to prevent accidental divergence of naming rules. Acceptance: (1) The helper is removed and no call sites depend on it; (2) constraint naming uses `ConstraintNaming` consistently; (3) build and unit tests remain green.",
    "steps-to-verify": [
      "Confirm no usages of `RelationalNameConventions.ForeignKeyName` remain outside the helper itself.",
      "Remove the helper from `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/RelationalNameConventions.cs` (or mark obsolete and add a follow-up task to remove).",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": false
  },
  {
    "category": "Refactor",
    "description": "DMS-931 follow-up: Remove brittle runtime type assumptions in `ApplyDialectIdentifierShorteningRelationalModelSetPass.UpdateProjectSchemas`. Acceptance: (1) Dialect shortening can update `ProjectSchemasInEndpointOrder` without throwing when the backing collection is not a mutable array/list; (2) behavior remains deterministic and stable across runs; (3) unit tests cover schema-shortening behavior; (4) build and unit tests remain green.",
    "steps-to-verify": [
      "Refactor `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/RelationalModelSetBuilderContext.cs` to expose a consistently-mutable representation for `ProjectSchemasInEndpointOrder` (or provide an explicit mutation method) so passes do not depend on the concrete backing type.",
      "Update `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel/ApplyDialectIdentifierShorteningRelationalModelSetPass.cs` to use the new mutation approach and remove the runtime type checks/throw.",
      "Add/adjust a unit test under `./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/` that exercises schema shortening via a small `MaxIdentifierLength` and asserts updated `PhysicalSchema` values.",
      "Run: `dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj`",
      "Run: `dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln`"
    ],
    "completed": true
  }
]
