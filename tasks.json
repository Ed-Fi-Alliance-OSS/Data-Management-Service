[
  {
    "category": "RelationalModel",
    "description": "Propagate ApiSchema `resourceSchema.isDescriptor` into the relational-model build context so descriptor resources can be handled with the shared `dms.Descriptor` storage design.",
    "stepsToVerify": [
      "Add a boolean (e.g., `IsDescriptorResource`) to the builder context and set it from ApiSchema in `ExtractInputsStep`.",
      "Add/adjust a unit test that builds a context for a known descriptor endpoint (e.g., `academicSubjectDescriptors`) and asserts `IsDescriptorResource == true`, and another non-descriptor endpoint (e.g., `schools`) asserts `false`.",
      "Run `dotnet test ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj` and ensure all tests pass."
    ],
    "completed": true
  },
  {
    "category": "RelationalModel",
    "description": "Introduce a first-class storage classification for resources (e.g., `ResourceStorageKind.RelationalTables` vs `ResourceStorageKind.SharedDescriptorTable`) and surface it in the relational-model manifest output.",
    "stepsToVerify": [
      "Add a `ResourceStorageKind` enum matching the design docs (see `reference/design/backend-redesign/design-docs/compiled-mapping-set.md`).",
      "Plumb the storage kind through the model/build result and emit it in `RelationalModelManifestEmitter` (acceptance: every resource manifest includes a `storage_kind` field).",
      "Update/extend unit tests to assert: non-descriptor resources emit `RelationalTables`; descriptor resources emit `SharedDescriptorTable`.",
      "Run the unit test project and confirm the authoritative manifest test passes after updating goldens."
    ],
    "completed": false
  },
  {
    "category": "RelationalModel",
    "description": "Stop generating per-resource tables for descriptor resources; instead model descriptor resources as using the shared `dms.Descriptor` table (no `{projectSchema}.{DescriptorName}` root table).",
    "stepsToVerify": [
      "Update the pipeline so when `IsDescriptorResource == true` the derived model does not call `DeriveTableScopesAndKeysStep`/generic table derivation for the descriptor resource, and does not create any tables named after the descriptor resource.",
      "Acceptance: building a model for a descriptor endpoint produces a root table of `dms.Descriptor` and `TablesInReadDependencyOrder` contains only that shared table (no child collection tables).",
      "Acceptance: descriptor resources still participate in `dms.ResourceKey` seeding (no change), and non-descriptor resources are unchanged.",
      "Run unit tests; add a targeted test asserting the absence of any table named like `AcademicSubjectDescriptor` when building that resource."
    ],
    "completed": false
  },
  {
    "category": "Tests",
    "description": "Update the authoritative relational-model golden fixture(s) so descriptor endpoints reflect shared-table storage rather than per-descriptor tables.",
    "stepsToVerify": [
      "Run `UPDATE_GOLDENS=1 dotnet test ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj` to regenerate goldens.",
      "Run the same `dotnet test` command again without `UPDATE_GOLDENS` and confirm it passes with an empty git diff for the fixture outputs.",
      "Acceptance: the generated manifest no longer contains `create`/table entries like `edfi.<SomeDescriptorName>` for descriptor resources, and descriptor resources include `storage_kind: SharedDescriptorTable`."
    ],
    "completed": false
  }
]
