2026-02-20
Task: Dependencies - add Backend.Ddl project reference in Backend.Plans (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: prioritized dependency wiring first (core abstraction prerequisite); reused existing Ddl SqlWriter/ISqlDialect path to avoid duplicated SQL formatting logic.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Plans/EdFi.DataManagementService.Backend.Plans.csproj; tasks.json
Feedback loops: dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass before + after change).
Blockers/notes: none. Next likely SQL Foundations helper layer in Backend.Plans.
2026-02-20
Task: SQL Foundations - add plan/query SqlWriter helpers for bare parameters + multiline WHERE (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: kept scope to helper layer only (contracts unchanged for next task); used Backend.Ddl.SqlWriter extension methods to preserve canonicalization behavior and avoid duplicate formatter logic.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Plans/PlanSqlWriterExtensions.cs; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_PlanSqlWriterExtensions.cs; tasks.json
Feedback loops: dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. Next likely Contracts task (bare parameter names + optional total count SQL contract).
2026-02-20
Task: Contracts - bare parameter-name contracts + optional total-count SQL (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: made bare names canonical in contracts and compiler validation via PlanSqlWriterExtensions; kept compiler behavior same except render placeholders as @name and gate total-count SQL behind IncludeTotalCountSql.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Plans/PageDocumentIdQueryModels.cs; src/dms/backend/EdFi.DataManagementService.Backend.Plans/PageDocumentIdSqlCompiler.cs; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_PageDocumentIdSqlCompiler.cs; tasks.json
Feedback loops: dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass); dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass).
Blockers/notes: none. Next likely Query Compiler task (SqlWriter/ISqlDialect internals + deterministic predicate ordering).
2026-02-20
Task: Query Compiler - refactor PageDocumentIdSqlCompiler to SqlWriter/ISqlDialect with deterministic predicate ordering + duplicate detection (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: made compiler emit through Backend.Ddl.SqlWriter for canonical output and shared quoting; treated predicates as unordered input by rewriting first then stable ordinal sort (presence/canonical/operator/parameter); fail-fast duplicate detection uses rewritten sort key to catch alias-collisions deterministically; statement termination normalized to ;\n for page + optional total-count SQL.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Plans/PageDocumentIdSqlCompiler.cs; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_PageDocumentIdSqlCompiler.cs; tasks.json
Feedback loops: dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. Next likely Unit Tests task cleanup/coverage alignment or Plan SQL toy INSERT emitter.
2026-02-20
Task: Test Infrastructure - shared authoritative fixture root + solution-root path resolution (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: moved authoritative INPUT ownership to src/dms/backend/Fixtures/authoritative for cross-project reuse; kept project-local EXPECTED goldens in relational-model tests to avoid coupling unrelated assertions to shared root.
Files changed: src/dms/backend/Fixtures/authoritative/ds-5.2/inputs/ds-5.2-api-schema-authoritative.json; src/dms/backend/Fixtures/authoritative/sample/inputs/sample-api-schema-authoritative.json; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/BackendFixturePaths.cs; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/RelationalModelAuthoritativeGoldenTests.cs; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/RelationalModelDerivedAuthoritativeGoldenTests.cs; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/DerivedRelationalModelSetAuthoritativeGoldenTests.cs; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EffectiveSchemaManifestGoldenTests.cs; src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/RelationalModelAuthoritativeStringMaxLengthAuditTests.cs; tasks.json
Feedback loops: dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit/EdFi.DataManagementService.Backend.RelationalModel.Tests.Unit.csproj (pass); dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Ddl.Tests.Unit/EdFi.DataManagementService.Backend.Ddl.Tests.Unit.csproj (pass); dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. Next likely Plan SQL toy INSERT emitter, then golden fixture harness task.
2026-02-20
Task: Plan SQL - add toy INSERT emitter with SqlWriter + ISqlDialect (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: implemented dedicated ToyInsertSqlEmitter (not generic builder) to keep thin-slice scope; preserved deterministic ordering from input lists and reused PlanSqlWriterExtensions.AppendParameter for bare-name validation + placeholder emission.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Plans/ToyInsertSqlEmitter.cs; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_ToyInsertSqlEmitter.cs; tasks.json
Feedback loops: dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. Next likely Unit Tests cleanup task or Golden Fixtures harness task.
2026-02-20
Task: Golden Fixtures - add minimal plan-sql-foundations golden harness in Backend.Tests.Unit (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: used fixture-scoped deterministic SQL generation (PageDocumentId + ToyInsert, Pgsql/Mssql) and git diff --no-index for readable drift; kept expected goldens checked in and actual outputs under TestContext work directory; wired UPDATE_GOLDENS=1/true auto-rewrite for maintainability.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_PlanSqlFoundations_GoldenFixture.cs; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Fixtures/small/plan-sql-foundations/minimal/expected/pgsql.page-document-id.sql; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Fixtures/small/plan-sql-foundations/minimal/expected/mssql.page-document-id.sql; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Fixtures/small/plan-sql-foundations/minimal/expected/pgsql.toy-insert.sql; src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Fixtures/small/plan-sql-foundations/minimal/expected/mssql.toy-insert.sql; tasks.json
Feedback loops: UPDATE_GOLDENS=1 dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. Next likely Unit Tests task.
2026-02-20
Task: Unit Tests - align Given_PageDocumentIdSqlCompiler coverage with contract semantics (story: reference/design/backend-redesign/epics/15-plan-compilation/01-plan-sql-foundations.md)
Decisions: widened dialect-agnostic null-total-count assertion to both Pgsql/Mssql; added explicit limit paging parameter-name rejection to close bare-name validation gap.
Files changed: src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/Given_PageDocumentIdSqlCompiler.cs; tasks.json
Feedback loops: dotnet test --no-restore ./src/dms/backend/EdFi.DataManagementService.Backend.Tests.Unit/EdFi.DataManagementService.Backend.Tests.Unit.csproj (pass); dotnet build --no-restore ./src/dms/EdFi.DataManagementService.sln (pass).
Blockers/notes: none. All tasks in tasks.json now complete.
